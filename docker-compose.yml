version: '3.9'
services:
  ollama:
    image: ollama/ollama:latest
    ports: [ "11435:11434" ]
    volumes: [ "./ollama_models:/root/.ollama" ]
    restart: unless-stopped

  backend:
    build: ./backend
    ports: [ "8000:8000" ]
    depends_on: [ ollama ]
    volumes:
      - ./backend:/app
      - ./data:/data
    environment: [ "OLLAMA_HOST=http://ollama:11434" ]
    restart: unless-stopped

  frontend:
    build: ./frontend
    ports: [ "5173:5173" ]
    depends_on: [ backend ]
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - VITE_API_URL=http://168.231.77.11:8000/api/v1
    restart: unless-stopped
